<head>
<link rel="stylesheet" type="text/css" href="main.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />

<!-- <link rel="stylesheet" type="text/css" href="./css/custom-theme/jquery-ui-1.9.2.custom.css"> -->
<link rel="stylesheet" type="text/css" href="./css/jquery-ui.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">


<script src="./dist/jquery-ui.js"></script>
<script src="./dist/leaflet.SliderControl.min.js"></script>
<script src="./dist/bouncemarker.js"></script>
<link href='https://fonts.googleapis.com/css?family=Tienne:900|Eczar:800' rel='stylesheet' type='text/css'>

<script src='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.js'></script>
<link href='https://api.mapbox.com/mapbox.js/v2.3.0/mapbox.css' rel='stylesheet' />

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.0.0/lodash.min.js"></script>

</head>

<body>

<div class="map-background">
	<div id="splashscreen">
		    <h2 id="splashscreen-header">Emergency Financial Managers and Michigan</h2>
		    <div id="splashscreen-text"> Here is some text explaining the situation</div>

		    <a href="#" class="btn enter_link" id="btn-splash">Investigate Further</a>
	</div>

	<div class="row">
		<div class="col-md-3" id="key-panel">
			<!-- <h4 id="key-heading"><u><b>LEGEND</b></u></h4> -->
			<h4 id="key-heading"><u>LEGEND</u></h4>
				<div class="row">
					<div class="symbol-legends col-md-7">
						<div class="symbol-column container">
							<div class="row symbol-container">
								<i class="fa fa-scissors fa-lg"></i><div class="symbol-label"><span>  </span> Layoffs</div>
							</div>
							<div class="row symbol-container">
								<i class="fa fa-credit-card fa-lg"></i><div class="symbol-label"> <span>  </span> Pensions Defunded</div>
							</div>
							<div class="row symbol-container">
								<i class="fa fa-tint fa-lg"></i><div class="symbol-label"> <span>  </span> Municipal Services</div>
							</div>
							<div class="row symbol-container">
								<i class="fa fa-graduation-cap fa-lg"></i><div class="symbol-label"> <span>  </span> Schools Closed</div>
							</div>
							<div class="row symbol-container">
								<i class="fa fa-user fa-lg"></i><div class="symbol-label"> <span>  </span> Police/Firemen related</div>
							</div>
						</div>
					</div>
					<div class="color-legends col-md-3">
							<div class="row color-container">
								<div class="color-box" id="brown"></div><div class="color-label"><span>  </span>Public Act 101</div>
							</div>
							<div class="row color-container">
								<div class="color-box" id="dark-grey"></div><div class="color-label"><span>  </span>Public Act 4</div>
							</div>
							<div class="row color-container">
								<div class="color-box" id="forest-green"></div><div class="color-label"><span>  </span>Public Act 436</div>
							</div>
					</div>
				</div>
		</div>
		<div class="col-md-9" id="select-menu">
			<div class="row">
				<div class="col-md-8">
					<div class="checkbox-container">
						<div class="checkbox-div">
							
							<h4><u>Legal Basis for Actions Taken</u></h4>
							
							<label for="PA101-checkbox">Public Act 101 of 1988<span>  </span><input type="checkbox" class="checkbox-law" id="PA101-checkbox" value=""></label></div><span> | </span>
							
							<div class="checkbox-div"><label for="PA4-checkbox">Public Act 4 of 2011<span>  </span><input type="checkbox" class="checkbox-law" id="PA4-checkbox" value=""></label></div><span> | </span>
							
							<div class="checkbox-div"><label for="PA436-checkbox">Public Act 436 of 2012<span>  </span><input type="checkbox" class="checkbox-law" id="PA436-checkbox" value=""></label>

						</div>
					</div>
				</div>
				<div class="col-md-4">
					<div class="slider-container">
						<p>
						  <label for="year">Date range:</label>
						  <input type="text" id="year" readonly>
						</p>
						 
						<div id="slider-range"></div>
					</div>
				</div>
			</div>
			<div class="checkbox-container">
				<h4><u>Actions Taken</u></h4>
				<div class="checkbox-div">
				  <label for="school-checkbox">Schools Closed<span>  </span><input type="checkbox" class="checkbox-consequences" id="school-checkbox" value=""></label>
				</div><span> | </span>
				<div class="checkbox-div">
				  <label for="pension-checkbox">Pensions Defunded<span>  </span><input type="checkbox" class="checkbox-consequences" id="pension-checkbox" value=""></label>
				</div><span> | </span>
				<div class="checkbox-div">
				  <label for="social-services-checkbox">Municipal Services Defunded/Outsourced<span>  </span><input type="checkbox" class="checkbox-consequences" id="social-services-checkbox" value=""></label>
				</div><span> | </span>
				<div class="checkbox-div">
				  <label for="layoffs-checkbox">Municipal Staff Layoffs<span>  </span><input type="checkbox" class="checkbox-consequences" id="layoffs-checkbox" value=""></label>
				</div><span> | </span>
				<div class="checkbox-div">
				  <label for="police-fire-checkbox">Police/Fire Department Reduced or Eliminated<span>  </span><input type="checkbox" class="checkbox-consequences" id="police-fire-checkbox" value=""></label>
				</div><span>  </span>
			</div>
		</div>
	</div>
<!-- Need to add heat maps on demographics -->
<!-- Need to add d3 graphs on demographics -->
<!-- Need to add info on race of emergency managers -->
<!-- Need to add lawsuit markers -->
<!-- Maybe graph looking at state overage during this time, see below -->
<!-- http://www.governing.com/topics/mgmt/gov-emergency-financial-managers-michigan-municipalities-unwelcome-savior.html -->
<!-- Some even blame Michigan for inflicting some of the pain Pontiac and other distressed cities are now experiencing. In early 2011, while promoting PA4, Snyder simultaneously advanced a budget eliminating one-third of the state revenue sharing set aside for localities -- about $307 million. That was on top of the $4 billion in state revenue that localities had lost over the last decade. While Pontiac struggles, the state ended last fiscal year with a reported $457 million surplus. That disparity has prompted some residents and elected officials to openly question whether Snyder’s budget, in concert with PA4, is an attempt by state leaders to systematically dismantle urban communities and promote a regionalized approach that favors counties. Schimmel’s immediate predecessor, Michael Stampfler, had suggested that the city consider filing for bankruptcy or being absorbed by Oakland County. The idea infuriated many residents, who viewed it as the state giving up on Pontiac. -->
	<div class="row">
		<div class="col-md-8">
			<div class="map-panel" id="map"></div>
		</div>
		<div class="col-md-4">
			<div class="details-panel" id="details"></div>
		</div>
	</div>
</div>

<script type="text/javascript">

L.mapbox.accessToken = 'pk.eyJ1Ijoic2hhd25vYWtsZXkiLCJhIjoiY2lrZzVzbGxmMDAyb3Y2bHlhaTNyZnN4eCJ9.5TE4YM7J3mhjIlnu-pLmLA';

var hamtramckCoordinates = [-83.0572, 42.3978];
var hamtramck2Coordinates = [-83, 42.3978];
var hamtramck3Coordinates = [-83.0572, 42.1];

var highlandParkCoordinates = [-83.1017, 42.4036];
var highlandPark2Coordinates = [-83, 42.4036];

var flintCoordinates = [-83.69, 43.01];
var flint2Coordinates = [-83.6, 43];

var threeOaksCoordinates = [-86.6106, 41.7986];
var detroitCoordinates = [-83.0458, 42.3314];
var ecorseCoordinates = [-83.1458, 42.2444];

var bentonHarborCoordinates = [-86.4483,42.1111];
var bentonHarbor2Coordinates = [-86.3,42.05];

var pontiacCoordinates = [-83.2925, 42.6461];
var muskegonHeightsCoordinates = [-86.2389, 43.2011];
var allenParkCoordinates = [-86.4483, 42.1111];

var completeFeatureCollection = {
	"type": "FeatureCollection",
	"features" : [
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": hamtramckCoordinates
	    },
	    "properties": {
	        "name": "hamtramck1",
	        "locationName": "Hamtramck",
	        "consequences": ["schools", "socialServices"],
	        "year": 1988,
	        "law": "Public Act 101",
	        'marker-size': 'large',
    		'marker-color': '#BE9A6B',
    		'marker-symbol': 'college'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": hamtramck2Coordinates
	    },
	    "properties": {
	        "name": "hamtramck2",
	        "locationName": "Hamtramck",
	        "consequences": ["socialServices"],
	        "year": 2000,
	        "law": "Public Act 101",
	        'marker-size': 'large',
    		'marker-color': '#BE9A6B',
    		'marker-symbol': 'water'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": highlandParkCoordinates
	    },
	    "properties": {
	        "name": "highLandPark1",
	        "locationName": "Highland Park",
	        "consequences": ["pensions"],
	        "year": 2000,
	        "law": "Public Act 101",
	        'marker-size': 'large',
    		'marker-color': '#BE9A6B',
    		'marker-symbol':'bank'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": flintCoordinates
	    },
	    "properties": {
	        "name": "flint1",
	        "locationName": "Flint",
	        "consequences": ["layoffs"],
	        "year": 2002,
	        "law": "Public Act 101",
	        'marker-size': 'large',
    		'marker-color': '#BE9A6B',
    		'marker-symbol':'hairdresser'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": threeOaksCoordinates
	    },
	    "properties": {
	        "name": "threeOaks1",
	        "locationName": "Three Oaks",
	        "consequences": ["policeFire"],
	        "year": 2008,
	        "law": "Public Act 101",
	        'marker-size': 'large',
    		'marker-color': '#BE9A6B',
    		'marker-symbol':'police'
	    }
	},
	{
	    "type": "Feature",
	    "properties": {
	        "name": "detroit1",
	        "locationName": "Detroit",
	        "consequences": ["schools"],
	        "year": 2009,
	        "law": "Public Act 101",
	        'marker-size': 'large',
    		'marker-color': '#BE9A6B',
    		'marker-symbol':'college'
	    },
	    "geometry": {
	        "type": "Point",
	        "coordinates": detroitCoordinates
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": bentonHarborCoordinates
	    },
	    "properties": {
	        "name": "bentonHarbor",
	        "locationName": "Benton Harbor",
	        "consequences": ["pensions"],
	        "year": 2010,
	        "law": "Public Act 4",
	        'marker-size': 'large',
    		'marker-color': '#6C7A89',
    		'marker-symbol':'bank'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": pontiacCoordinates
	    },
	    "properties": {
	        "name": "pontiacHarbor",
	        "locationName": "Pontiac",
	        "consequences": ["layoffs"],
	        "year": 2010,
	        "law": "Public Act 4",
	        'marker-size': 'large',
    		'marker-color': '#6C7A89',
    		'marker-symbol':'hairdresser'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": flint2Coordinates
	    },
	    "properties": {
	        "name": "flint2",
	        "locationName": "Flint",
	        "consequences": ["schools"],
	        "year": 2011,
	        "law": "Public Act 4",
	        'marker-size': 'large',
    		'marker-color': '#6C7A89',
    		'marker-symbol':'college'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": highlandPark2Coordinates
	    },
	    "properties": {
	        "name": "highlandPark2",
	        "locationName": "Highland Park",
	        "consequences": ["policeFire"],
	        "year": 2012,
	        "law": "Public Act 436",
	        'marker-size': 'large',
    		'marker-color': '#878F5A',
    		'marker-symbol':'police'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": muskegonHeightsCoordinates
	    },
	    "properties": {
	        "name": "muskegonHeights1",
	        "locationName": "Muskegon Heights",
	        "consequences": ["pensions"],
	        "year": 2012,
	        "law": "Public Act 436",
	        'marker-size': 'large',
    		'marker-color': '#878F5A',
    		'marker-symbol':'bank'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": allenParkCoordinates
	    },
	    "properties": {
	        "name": "allenPark1",
	        "locationName": "Allen Park",
	        "consequences": ["layoffs"],
	        "year": 2012,
	        "law": "Public Act 436",
	        'marker-size': 'large',
    		'marker-color': '#878F5A',
    		'marker-symbol':'hairdresser'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": hamtramck3Coordinates
	    },
	    "properties": {
	        "name": "hamtramck3",
	        "locationName": "Hamtramck",
	        "consequences": ["policeFire"],
	        "year": 2013,
	        "color": "green",
	        "law": "Public Act 436",
	        'marker-size': 'large',
    		'marker-color': '#878F5A',
    		'marker-symbol':'police'
	    }
	},
	{
	    "type": "Feature",
	    "geometry": {
	        "type": "Point",
	        "coordinates": bentonHarbor2Coordinates
	    },
	    "properties": {
	        "name": "bentonHarbor2",
	        "locationName": "Benton Harbor",
	        "consequences": ["socialServices"],
	        "year": 2013,
	        "color": "green",
	        "law": "Public Act 436",
	        'marker-size': 'large',
    		'marker-color': '#878F5A',
    		'marker-symbol':'water'
	    }
	}]
};

// Need to do:
// Add key
// Change colors to grey scale
// Add letters to markers which list consequences for each marker (which correspond to uses of the law) (e.g., marker where school incident and police layoff happened will have SP in marker)
// Add popups
// Add slider for year
// Add more informative tooltips
// https://www.mapbox.com/mapbox.js/example/v1.0.0/marker-tooltips-outside-map/

// https://stackoverflow.com/questions/16537326/leafletjs-how-to-remove-the-zoom-control
// Set zoomControl to true when splash screen closes
var map = L.map('map', {zoomControl: false}).setView([42.5,-84.5], 7);


$(document).ready(function(){
	$("#splashscreen").fadeIn("slow");

// https://stackoverflow.com/questions/426258/checking-a-checkbox-with-jquery
// https://stackoverflow.com/questions/10159214/why-does-dynamically-changing-a-checkbox-not-trigger-a-form-change-event
    $('#PA101-checkbox').prop('checked',true);
    $('#PA4-checkbox').prop('checked',true);
    $('#PA436-checkbox').prop('checked',true);

    $('#school-checkbox').prop('checked',true);
    $('#pension-checkbox').prop('checked',true);
    $('#social-services-checkbox').prop('checked',true);
    $('#layoffs-checkbox').prop('checked',true);
    $('#police-fire-checkbox').prop('checked',true);

    $( "#slider-range" ).slider({
      range: true,
      min: 1988,
      max: 2016,
      values: [ 1988, 2016 ],
      slide: function( event, ui ) {
        $( "#year" ).val( $( "#slider-range" ).slider( "values", 0 ) + " - " + $( "#slider-range" ).slider( "values", 1 ) );
      }
    });
    $( "#year" ).val( $( "#slider-range" ).slider( "values", 0 ) +
      " - " + $( "#slider-range" ).slider( "values", 1 ) );

});

$('.enter_link').click(function() { 
    $(this).parent().fadeOut("slow");
    new L.Control.Zoom({ position: 'topleft' }).addTo(map)
 });

var selectedStatuteArray = ["Public Act 4", "Public Act 436", "Public Act 101"];

var selectedConsequenceArray = ["schools","pensions","socialServices", "policeFire", "layoffs"]

var findInStatuteArray = function(feature){
	return selectedStatuteArray.includes(feature.properties.law);
};

// https://stackoverflow.com/questions/16312528/check-if-an-array-contains-any-elements-in-another-array-in-javascript

var selectedYearRangeArray = [1988, 2016]

var filterObject = {selectedStatutes: selectedStatuteArray, selectedConsequences: selectedConsequenceArray,
	selectedYearRange: selectedYearRangeArray};

var myLayer = L.mapbox.featureLayer().setFilter(function(feature) {
  return filterObject.selectedStatutes.includes(feature.properties.law) && filterObject.selectedConsequences.some(function(consequence) {
	  		return feature.properties.consequences.indexOf(consequence) >= 0;
	  });
}).addTo(map);

var updateFilter = function() {
	myLayer.setFilter(function(feature) {
	  return filterObject.selectedStatutes.includes(feature.properties.law) && filterObject.selectedConsequences.some(function(consequence) {
	  		return feature.properties.consequences.indexOf(consequence) >= 0;
	  }) && (feature.properties.year >= filterObject.selectedYearRange[0] && feature.properties.year <= filterObject.selectedYearRange[1]);
	});
};
// https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png?access_token={accessToken}
// https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png?access_token={accessToken}
// https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lines/{z}/{x}/{y}.png?access_token={accessToken}
// https://stamen-tiles-{s}.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png?access_token={accessToken}
// https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png?access_token={accessToken}
L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://mapbox.com">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox.satellite',
    accessToken: 'pk.eyJ1Ijoic2hhd25vYWtsZXkiLCJhIjoiY2lrZzVzbGxmMDAyb3Y2bHlhaTNyZnN4eCJ9.5TE4YM7J3mhjIlnu-pLmLA'
}).addTo(map);

// https://www.mapbox.com/mapbox.js/example/v1.0.0/marker-tooltips-outside-map/

var info = document.getElementById('details');

function empty() {
  info.innerHTML = '<div><strong>Click a marker</strong></div>';
  }


myLayer.setGeoJSON(completeFeatureCollection);
// Listen for individual marker clicks.
myLayer.on('click',function(e) {
    // Force the popup closed.
    e.layer.closePopup();

    var feature = e.layer.feature;
    var content = '<h3>'+'Event Details'+'</h3>'+'<div><strong> City: ' + feature.properties.locationName + '</strong>' + '<p><div>Legal basis: ' + feature.properties.law + '</div></p>'+'<p><div>Year: ' + feature.properties.year + '</div></p>'+'<p><div>Action taken: ' + feature.properties.consequences + '</div></p>'+'<p><div>Description: ' + 'This is where the description goes.' + '</div></p>'+'</div>'+"<button style='color:black' id='back-button'>Back</button>";

    info.innerHTML = content;
    $(info).show();
    $('#back-button').on('click', function(){
	updateFromSplashIntro();
});

});

var updateFromSplashIntro = function(){
	var content ='<h3>'+$('#splashscreen-header').text()+'</h3><div><strong>'+$('#splashscreen-text').text()+'</strong></div>';
	var info = document.getElementById('details');
	console.log(info)
	console.log(content);
	info.innerHTML=content;
	$(info).show();
}

$('#btn-splash').on('click', function(){
	updateFromSplashIntro();
});

$('#back-button').on('click', function(){
	updateFromSplashIntro();
});


// Clear the tooltip when map is clicked.
map.on('move', empty);

// Trigger empty contents when the script
// has loaded on the page.
empty();

// https://www.mapbox.com/mapbox.js/api/v2.1.5/l-mapbox-featurelayer/#section-featurelayer-setfilter
var addToStatuteArray = function(string, statuteArray) {
	statuteArray.push(string);
};

var addToConsequencesArray = function(string, consequencesArray) {
	consequencesArray.push(string);
};

var setFilterRange = function(date1, date2) {
	filterObject.selectedYearRange = [date1, date2];
}

// Using updateFilter method to clear markers based on presence of statute in checked boxes
    $('#PA4-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToStatuteArray("Public Act 4", filterObject.selectedStatutes)
    	} else {
    		filterObject.selectedStatutes = _.filter(filterObject.selectedStatutes, function(statute){
    			return statute != "Public Act 4";
    		});
    	}
    	updateFilter();
    });
    $('#PA436-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToStatuteArray("Public Act 436", filterObject.selectedStatutes)
    	} else {
    		filterObject.selectedStatutes = _.filter(filterObject.selectedStatutes, function(statute){
    			return statute != "Public Act 436";
    		});
    	}
    	updateFilter();
    });

    $('#PA101-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToStatuteArray("Public Act 101", filterObject.selectedStatutes);
    	} else {
    		filterObject.selectedStatutes = _.filter(filterObject.selectedStatutes, function(statute){
    			return statute != "Public Act 101";
    		});
    	}

    	updateFilter();
    });

    $('#school-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToConsequencesArray("schools", filterObject.selectedConsequences);
    	} else {
    		filterObject.selectedConsequences = _.filter(filterObject.selectedConsequences, function(statute){
    			return statute != "schools";
    		});
    	}

    	updateFilter();
    });
// var selectedConsequenceArray = ["schools","pensions","socialServices", "policeFire", "layoffs"]


    $('#pension-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToConsequencesArray("pensions", filterObject.selectedConsequences);
    	} else {
    		filterObject.selectedConsequences = _.filter(filterObject.selectedConsequences, function(statute){
    			return statute != "pensions";
    		});
    	}

    	updateFilter();
    });

    $('#social-services-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToConsequencesArray("socialServices", filterObject.selectedConsequences);
    	} else {
    		filterObject.selectedConsequences = _.filter(filterObject.selectedConsequences, function(statute){
    			return statute != "socialServices";
    		});
    	}

    	updateFilter();
    });

    $('#layoffs-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToConsequencesArray("layoffs", filterObject.selectedConsequences);
    	} else {
    		filterObject.selectedConsequences = _.filter(filterObject.selectedConsequences, function(statute){
    			return statute != "layoffs";
    		});
    	}

    	updateFilter();
    });

    $('#police-fire-checkbox').change(function(){
    	if ($(this).is(':checked')) {
    		addToConsequencesArray("policeFire", filterObject.selectedConsequences);
    	} else {
    		filterObject.selectedConsequences = _.filter(filterObject.selectedConsequences, function(statute){
    			return statute != "policeFire";
    		});
    	}

    	updateFilter();
    });


    $("#slider-range").on('slidechange', function(){
    	setFilterRange($( "#slider-range" ).slider( "values", 0 ), $( "#slider-range" ).slider( "values", 1 ));

    	updateFilter();
    });

</script>
</body>

